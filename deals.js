//  Create an object for each deal that currently exists - seperate to own js file later
const deal1 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D1",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal2 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D2",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal3 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D3",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal4 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D4",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal5 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D5",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal6 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D6",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal7 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D7",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal8 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D8",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

const deal9 = {
    front: {
        imageUrl: "./assets/images/coffee-requires-crop-resize.jfif",
        title: "Espresso Coffee",
        price: "$3.00",
        venue: "Lugo Cafe",
        description: "Indulge in the rich aroma & exquisite taste of our carefully brewed coffees at Lugo Cafe. Whether you're an early riser in need of your morning fix or looking for a cozy spot to unwind, we've got you covered.",
        itemTitle: "1x Regular Sized Coffee."
    },
    back: {
        barcodeUrl: "./assets/images/0744109970238.jpg",
        price: "$3.00",
        venue: "Lugo Cafe",
        location: "Lugo Cafe, 100 Marine Terrace, Geraldton W.A",
        redeemInfo1: "To claim this offer, simply present this card at the counter when placing your order. Test-D9",
        redeemInfo2: "This offer is valid for a regular-sized coffee & cannot be combined with other promotions. Specialty drinks are not included. The offer is valid for the date of 01/01/23 between 9am - 5pm."
        // Additional back card information
    }
};

// Deals schedule - The 3 x deals that should be displayed on each day of the week
const weeklyDeals = {
    'Monday':   [deal1, deal2, deal3],
    'Tuesday':  [deal4, deal5, deal6],
    'Wednesday': [deal7, deal8, deal9],
    'Thursday': [deal1, deal2, deal3],
    'Friday':   [deal4, deal5, deal6],
    'Saturday': [deal7, deal8, deal9],
    'Sunday':   [deal4, deal5, deal6],
};

// Returns the deals for the current day
const getCurrentDayDeals = () => {
    const today = new Date().toLocaleDateString('en-us', { weekday: 'long' });
    return weeklyDeals[today];
}

// Renders the deal cards to the UI - with the data returned from getCurrentDayDeals
const renderDealCards = () => {
    const todayDeals = getCurrentDayDeals();
    const cardsContainer = document.querySelector('.deals-multicard-wrapper');

    // Build up the entire HTML string in the loop and then set innerHTML once at the end. (for all 3 cards)
    let cardsHtml = '';

    todayDeals.forEach(card => {
        cardsHtml += `
            <div class="card">
                <div class="card--front">
                    <div class="img-wrapper">
                        <img src="${card.front.imageUrl}" alt="a delicious coffee">
                    </div>
                    <div class="card__bottom">
                        <div class="card__title-price-wrapper">
                            <h3 class="card__title">${card.front.title}</h3>
                            <p class="card__price">${card.front.price}</p>
                        </div>
                        <h4 class="card__venue">${card.front.venue}</h4>
                        <p class="card__text">${card.front.description}</p>
                        <p class="card__item__title">${card.front.itemTitle}</p>
                        <button class="card-front-CTA-btn">Claim Deal</button>
                    </div>
                </div>
                <div class="card--back">
                    <i class="fa-solid fa-circle-left card-back-btn"></i>
                    <div class="barcode-wrapper">
                        <img src="${card.back.barcodeUrl}" alt="barcode to scan">
                    </div>
                    <p><span class="card--back__main-heading-price">${card.back.price} - </span><span class="card--back__main-heading-venue">${card.back.venue}</span></p>
                    <div class="card--back__text-wrapper">
                        <p class="card--back__sub-title">Location:</p>
                        <p class="card--back__body-text">${card.back.location}</p>
                        <p class="card--back__sub-title">Redeem:</p>
                        <p class="card--back__body-text">${card.back.redeemInfo1}</p>
                        <p class="card--back__sub-title">Redeem:</p>
                        <p class="card--back__body-text">${card.back.redeemInfo2}</p>
                    </div>
                </div>
            </div>
        `;
    });
    cardsContainer.innerHTML = cardsHtml;
};

// Automatically update the deal cards on the website at midnight each day
const scheduleDealUpdate = () => {
    const now = new Date();
    const nextMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
    // Calculates the time (in milliseconds) until the next midnight.
    const timeUntilMidnight = nextMidnight.getTime() - now.getTime();

    setTimeout(() => {
        renderDealCards();
        scheduleDealUpdate(); // Reschedule for the next day
    }, timeUntilMidnight);
}


document.addEventListener('DOMContentLoaded', () => {
    // Render cards first
    renderDealCards();
    scheduleDealUpdate();

    // Event delegation for card flipping
    const cardsContainer = document.querySelector('.deals-multicard-wrapper');
    cardsContainer.addEventListener("click", function(event) {
        // Check if the clicked element or its parent is a card
        const card = event.target.closest('.card');
        if (card) {
            card.classList.toggle("is-flipped");
        }
    });
});
